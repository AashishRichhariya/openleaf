@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* Core palette */
  --primary: #2F855A;           /* Main brand/accent color */
  --primary-rgb: 47, 133, 90;   /* RGB values for opacity variants */
  --surface-dark: #1E2D24;      /* Main background */
  --surface-medium: #2F3C33;    /* Editor background */
  --surface-light: #364A3F;     /* Borders */
  --text: #E6EBE8;              /* Main text color */

  /* Derived colors - automatically calculated from core palette */
  --primary-20: rgba(var(--primary-rgb), 0.2);
  --primary-50: rgba(var(--primary-rgb), 0.5);
  --primary-80: rgba(var(--primary-rgb), 0.8);

  /* Application of core palette to specific UI elements */
  --background: var(--surface-dark);
  --foreground: var(--text);
  --editor-bg: var(--surface-medium);
  --editor-border: var(--surface-light);
  --accent: var(--primary);
  --accent-rgb: var(--primary-rgb);

  /* Grayscale palette */
  --gray-50: #F9FAFB;
  --gray-100: #F3F4F6;
  --gray-200: #E5E7EB;
  --gray-300: #D1D5DB;
  --gray-400: #9CA3AF;
  --gray-600: #4B5563;
  --gray-700: #374151;
  --gray-800: #1F2937;

  /* Semantic colors for UI elements */
  --placeholder-text: var(--gray-400);
  --quote-border: var(--primary);
  --checkbox-border: var(--gray-400);
  --checkbox-checked-bg: var(--primary);
  --checkbox-checkmark: white;
  --code-bg: var(--gray-800);
  --dropdown-chevron: #444;

  /* Table colors */
  --table-border: var(--gray-600);
  --table-cell-bg: var(--gray-800);
  --table-header-bg: var(--gray-700);
  --table-selected-bg: var(--primary-20);
  --table-striping: var(--gray-700);

  /* Form input colors */
  --input-border: var(--gray-300);
  --input-text: var(--text);
  --input-bg: rgba(var(--primary-rgb), 0.05);
  --input-focus-border: var(--primary);
  --input-focus-bg: rgba(var(--primary-rgb), 0.1);
  --input-focus-shadow: rgba(var(--primary-rgb), 0.2);
  --input-placeholder: var(--gray-400);
}

body {
  color: var(--foreground);
  background: var(--background);
  font-family: Arial, Helvetica, sans-serif;
}

@layer components {
   /* Navbar Components */
   .navbar {
    @apply w-full bg-transparent;
  }

  .navbar-container {
    @apply flex justify-between items-center mx-auto px-6 h-16 max-w-7xl;
  }

  .navbar-logo {
    @apply flex items-center;
  }

  .navbar-links {
    @apply flex items-center space-x-6;
  }

  /* Base editor components */
  .editor-main {
    @apply flex flex-col min-h-screen;
  }


  .editor-root {
    @apply flex-grow w-full flex justify-center bg-background;
  }

  .editor-area {
    @apply w-full max-w-4xl flex-grow flex flex-col relative
           bg-editor-bg shadow-lg px-8 py-12 mb-4 cursor-text
           rounded-squircle;
  }

  .editor-wrapper {
    @apply h-full flex flex-col w-full;
  }

  .editor-input {
    @apply flex-1 resize-none outline-none caret-accent min-h-full;
  }

  .editor-placeholder {
    @apply absolute top-12 left-8 text-placeholder-text pointer-events-none select-none;
  }

  /* Node-specific styles */
  .editor-heading-h1 {
    @apply text-4xl font-bold mt-6 mb-4;
  }

  .editor-heading-h2 {
    @apply text-3xl font-bold mt-5 mb-3;
  }

  .editor-heading-h3 {
    @apply text-2xl font-bold mt-4 mb-2;
  }

  .editor-quote {
    @apply border-l-4 border-quote-border pl-4 my-4 italic text-placeholder-text;
  }

  .editor-code {
    @apply bg-code-bg p-2 rounded font-mono text-sm;
  }

  /* Base list styles */
   .editor-list-ul {
    @apply p-0 m-0 list-disc list-outside;
  }

  .editor-list-ol {
    @apply p-0 m-0 list-decimal list-outside;
  }

  /* List item styles */
  .editor-listitem {
    @apply mx-8;
  }

  /* Nested list item */
  .editor-nested-listitem {
    @apply list-none;
  }

  /* Different depth ordered lists styles */
  .editor-list-ol1 {
    @apply p-0 m-0 list-decimal list-outside;
  }

  .editor-list-ol2 {
    @apply p-0 m-0 list-[upper-roman] list-outside;
  }

  .editor-list-ol3 {
    @apply p-0 m-0 list-[lower-roman] list-outside;
  }

  .editor-list-ol4 {
    @apply p-0 m-0 list-[upper-alpha] list-outside;
  }

  .editor-list-ol5 {
    @apply p-0 m-0 list-[lower-alpha] list-outside;
  }

  /* Different depth unordered lists styles */
  .editor-list-ul1 {
    @apply p-0 m-0 list-disc list-outside;
  }

  .editor-list-ul2 {
    @apply p-0 m-0 list-[circle] list-outside;
  }

  .editor-list-ul3 {
    @apply p-0 m-0 list-[square] list-outside;
  }

  /* Checkbox list styles */
  .editor-checklist {
    @apply p-0 m-0 list-none;
  }

  /* Base checkbox item styles */
  .editor-listitem-checked,
  .editor-listitem-unchecked {
    @apply relative mx-2 px-6 list-none outline-none;
  }

  /* Checked state */
  .editor-listitem-checked {
    @apply line-through;
  }

  /* Checkbox appearance */
  .editor-listitem-checked::before,
  .editor-listitem-unchecked::before {
    @apply content-[''] absolute w-4 h-4 top-0.5 left-0 cursor-pointer block bg-cover;
  }

  .editor-listitem-unchecked::before {
    @apply border border-checkbox-border rounded;
  }

  .editor-listitem-checked::before {
    @apply border border-checkbox-checked-bg rounded bg-checkbox-checked-bg bg-no-repeat;
  }

  /* Checkmark */
  .editor-listitem-checked::after {
    @apply content-[''] cursor-pointer border-checkbox-checkmark border-solid absolute block top-1.5 w-[3px] left-[7px] right-[7px] h-1.5 rotate-45 border-0 border-r-2 border-b-2;
  }

  /* Hide original checkbox for nested items */
  .editor-nested-listitem::before,
  .editor-nested-listitem::after {
    @apply hidden;
  }

  /* Ensure nested checkboxes maintain proper positioning */
  .editor-nested-listitem .editor-listitem-checked,
  .editor-nested-listitem .editor-listitem-unchecked {
    @apply relative mx-2;
  }

  /* RTL support */
  .editor-listitem-checked[dir='rtl']::before,
  .editor-listitem-unchecked[dir='rtl']::before {
    @apply left-auto right-0;
  }

  /* Focus styles */
  .editor-listitem-checked:focus::before,
  .editor-listitem-unchecked:focus::before {
    @apply outline-none;
  }
  /* Indentation support */
  .editor-indent {
    --indent-base-value: 40px;
  }

  /* Typeahead Menu Components */
  .typeahead-popover {
    @apply fixed bg-editor-bg shadow-lg rounded-lg py-2;
  }

  .typeahead-popover ul {
    @apply p-0 m-0 list-none rounded-lg max-h-64 overflow-y-scroll;
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .typeahead-popover ul::-webkit-scrollbar {
    @apply hidden;
  }

  .typeahead-popover ul li {
    @apply m-0 min-w-[180px] text-sm outline-none cursor-pointer rounded-lg;
  }

  .typeahead-popover ul li.selected {
    @apply bg-gray-700;
  }

  .typeahead-popover li {
    @apply mx-2 p-2 text-foreground cursor-pointer leading-4 text-sm flex items-center flex-row flex-shrink-0 bg-editor-bg rounded-lg border-0;
  }

  .typeahead-popover li.active {
    @apply flex w-5 h-5 bg-contain;
  }

  .typeahead-popover li:first-child {
    @apply rounded-t-lg;
  }

  .typeahead-popover li:last-child {
    @apply rounded-b-lg;
  }

  .typeahead-popover li:hover {
    @apply bg-gray-700;
  }

  .typeahead-popover li .text {
    @apply flex leading-5 flex-grow min-w-[150px];
  }

  .typeahead-popover li .icon {
    @apply flex w-5 h-5 select-none mr-2 leading-4 bg-contain bg-no-repeat bg-center;
  }

  /* Component Picker Specific */
  .component-picker-menu {
    @apply w-[200px];
  }

  .component-picker-menu .item {
    @apply items-center cursor-pointer flex flex-row p-2 mx-2 rounded;
  }

  .component-picker-menu .item.selected {
    @apply bg-gray-700;
  }

  .component-picker-menu .item:hover {
    @apply bg-gray-700;
  }

  .component-picker-menu .item .icon {
    @apply flex mr-2 w-5 h-5 select-none;
  }

  .component-picker-menu .item .text {
    @apply flex leading-5 flex-grow min-w-[150px];
  }

  /* Table wrapper */
  .editor-table-scrollable-wrapper {
    @apply overflow-x-auto my-0 mr-6 ml-0;
  }

  /* Base table */
  .editor-table {
    @apply border-collapse border-2 border-table-border table-fixed w-full mt-6 mb-8 min-w-[200px];
  }

  /* Table alignment */
  .editor-table-align-center {
    @apply mx-auto;
  }

  .editor-table-align-right {
    @apply ml-auto;
  }

  /* Table cells */
  .editor-table-cell {
    @apply border border-table-border align-top text-left p-2 relative outline-none bg-table-cell-bg;
  }

  /* Table header cells */
  .editor-table-cell-header {
    @apply border border-table-border bg-table-header-bg text-left;
  }

  /* Selected states */
  .editor-table-selected {
    @apply outline-2 outline outline-accent;
  }

  .editor-table-cell-selected {
    @apply caret-transparent relative;
  }

  .editor-table-cell-selected::after {
    @apply absolute inset-0 bg-table-selected-bg mix-blend-multiply
           content-[''] pointer-events-none;
  }

  /* Row striping */
  .editor-table-row-striping tr:nth-child(even) {
    @apply bg-table-striping;
  }

  /* Frozen columns/rows */
  .editor-table-frozen-row {
    @apply overflow-x-clip;
  }

  .editor-table-frozen-row tr:first-child > td {
    @apply overflow-clip bg-table-header-bg sticky z-10 top-[44px];
  }

  .editor-table-frozen-row tr:first-child > th {
    @apply overflow-clip bg-table-header-bg sticky z-10 top-[44px];
  }

  /* Cell resizer */
  .editor-table-cell-resizer {
    @apply absolute -right-1 h-full w-2 cursor-ew-resize z-10 top-0;
  }

  /* Add columns/rows buttons */
  .editor-table-add-columns,
  .editor-table-add-rows {
    @apply absolute bg-accent animate-[table-controls_0.2s_ease] border-0
           cursor-pointer hover:bg-accent-80;
  }

  .editor-table-add-columns::before,
  .editor-table-add-rows::before {
    @apply content-['+'] absolute top-0 bottom-0 left-0 right-0 flex items-center justify-center;
  }

  /* Cell action button */
  .table-cell-action-button-container {
    @apply absolute z-10 top-0 left-2 opacity-0 transition-opacity duration-100;
  }

  .table-cell-action-button-container-active {
    @apply opacity-100 pointer-events-auto;
  }

  .table-cell-action-button-container-inactive {
    @apply opacity-0 pointer-events-none;
  }

  .table-cell-action-button {
    @apply bg-table-cell-bg border border-table-border rounded-full w-6 h-6
           flex items-center justify-center cursor-pointer;
  }

  .table-cell-action-button:hover {
    @apply bg-table-header-bg;
  }

  .table-cell-action-button i.table-cell-action-button-icon {
    @apply inline-block;
    /* Custom chevron - can't convert directly to Tailwind */
    border-left: 4px solid transparent;
    border-right: 4px solid transparent;
    border-top: 5px solid var(--dropdown-chevron);
  }


  .table-action-menu-dropdown {
    @apply bg-table-cell-bg rounded shadow-md fixed z-50 w-52 opacity-0
           transition-opacity duration-100;
  }

  .table-action-menu-dropdown .table-action-menu-item {
    @apply flex items-center px-3 py-2 border-0 bg-transparent
           w-full text-left cursor-pointer text-sm text-foreground;
  }

  .table-action-menu-dropdown .table-action-menu-item:hover {
    @apply bg-table-header-bg;
  }

  .table-action-menu-dropdown hr {
    @apply my-1 border-0 border-t border-table-border;
  }

  /* Selection handling */
  .editor-table-selection *::selection {
    @apply bg-transparent;
  }

  /* Animation for controls */
  @keyframes table-controls {
    from { @apply opacity-0; }
    to { @apply opacity-100; }
  }

  /* Inline Table Input styles */
  .editor-table-input-wrapper {
    @apply inline-block;
  }

  .editor-table-input {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: inherit;
    line-height: inherit;
    user-select: none;
  }

  .editor-table-input input {
    @apply w-10 h-6 py-0.5 px-1
           border border-input-border
           rounded bg-input-bg text-input-text text-center;
  }

  .editor-table-input input:focus {
    @apply outline-none border-input-focus-border bg-input-focus-bg;
    /* We can't use @apply for complex shadows with variables, so keeping this direct */
    box-shadow: 0 0 0 2px var(--input-focus-shadow);
  }

  .editor-table-input input::placeholder {
    @apply text-input-placeholder opacity-80;
  }

  /* Hide number input spinner buttons */
  .editor-table-input input::-webkit-outer-spin-button,
  .editor-table-input input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  .editor-table-input input[type=number] {
    -moz-appearance: textfield;
  }
}
